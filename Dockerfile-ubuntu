FROM openjdk:11

MAINTAINER Agonaudid
ADD . /arete
WORKDIR /arete

ENV JAVA_OPTS=""

# Run Maven build
RUN chmod +x mvnw && ./mvnw install -DskipTests

# Run cleanup
RUN if [ -d "/students" ]; then rm -Rf /students; fi
RUN if [ -d "/tests" ]; then rm -Rf /tests; fi

# Fire up our Spring Boot app by default
ENTRYPOINT [ "sh", "-c", "java $JAVA_OPTS -Djava.security.egd=file:/dev/./urandom -jar target/arete-0.0.1-SNAPSHOT.jar" ]

EXPOSE 8098:8098
